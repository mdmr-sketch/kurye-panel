<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kurye Takip Paneli</title>

<style>
body { font-family: Arial; background:#f4f4f4; padding:10px; }
h2,h3 { text-align:center; }
input, select, button {
  width:100%; padding:10px; margin:6px 0; font-size:15px;
}
button { border:none; border-radius:6px; background:#007bff; color:white; }
.card {
  background:white; padding:10px; margin:8px 0; border-radius:8px;
}
.badge { font-weight:bold; }
.active { color:green; }
.break { color:orange; }
.off { color:red; }
</style>
</head>

<body>

<h2>ðŸšš Kurye & SipariÅŸ Takip</h2>

<!-- KURYE EKLE -->
<h3>ðŸ‘¤ Kurye Durumu</h3>
<input id="kuryeAdi" placeholder="Kurye AdÄ±">
<select id="kuryeDurum">
  <option value="Aktif">Aktif</option>
  <option value="Molada">Molada</option>
  <option value="Ä°zinli">Ä°zinli</option>
</select>
<button onclick="kuryeEkle()">âž• Kurye Ekle / GÃ¼ncelle</button>

<div id="kuryeListe"></div>

<hr>

<!-- SÄ°PARÄ°Åž -->
<h3>ðŸ“¦ SipariÅŸ Ekle</h3>
<input id="isletme" placeholder="Ä°ÅŸletme AdÄ±">
<input id="paket" type="number" placeholder="Paket Adedi">
<select id="siparisKurye"></select>
<button onclick="siparisEkle()">âž• SipariÅŸ Ekle</button>

<div id="siparisListe"></div>

<hr>

<button style="background:green" onclick="csvIndir()">ðŸ“¥ GÃ¼nlÃ¼k Raporu (Excel) Ä°ndir</button>

<script>
let kuryeler = JSON.parse(localStorage.getItem("kuryeler")) || [];
let siparisler = JSON.parse(localStorage.getItem("siparisler")) || [];
let gun = localStorage.getItem("gun") || new Date().toDateString();

if (gun !== new Date().toDateString()) {
  localStorage.removeItem("siparisler");
  siparisler = [];
  localStorage.setItem("gun", new Date().toDateString());
}

// KURYE
function kuryeEkle(){
  const ad = kuryeAdi.value;
  const durum = kuryeDurum.value;
  if(!ad) return alert("Kurye adÄ± gerekli");

  const mevcut = kuryeler.find(k => k.ad === ad);
  if(mevcut) mevcut.durum = durum;
  else kuryeler.push({ ad, durum });

  kaydet();
}

function kuryeGoster(){
  kuryeListe.innerHTML = "";
  siparisKurye.innerHTML = "<option value=''>Kurye SeÃ§</option>";

  kuryeler.forEach(k=>{
    const sayi = siparisler
      .filter(s => s.kurye === k.ad && s.durum !== "Teslim Edildi")
      .reduce((a,b)=>a+Number(b.paket),0);

    kuryeListe.innerHTML += `
      <div class="card">
        <b>${k.ad}</b> â€“
        <span class="badge ${k.durum==='Aktif'?'active':k.durum==='Molada'?'break':'off'}">
          ${k.durum}
        </span>
        <div>ðŸ“¦ Ãœzerindeki Paket: ${sayi}</div>
      </div>
    `;
    if(k.durum === "Aktif")
      siparisKurye.innerHTML += `<option>${k.ad}</option>`;
  });
}

// SÄ°PARÄ°Åž
function siparisEkle(){
  const isletme = document.getElementById("isletme").value;
  const paket = document.getElementById("paket").value;
  const kurye = document.getElementById("siparisKurye").value;
  if(!isletme || !paket || !kurye)
    return alert("TÃ¼m alanlar gerekli");

  siparisler.push({
    isletme, paket, kurye,
    durum:"Kuryede",
    zaman:new Date().toLocaleTimeString()
  });
  kaydet();
}

function siparisGoster(){
  siparisListe.innerHTML = "";
